<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>é”™è¯¯æ•è·</title>
    <link rel="stylesheet" href="./node_modules/rrweb/dist/rrweb-all.min.css" />
    <link rel="stylesheet" href="./node_modules/rrweb-player/dist/style.css" />
  </head>
  <body>
    <script src="./node_modules/rrweb/dist/rrweb-all.min.js"></script>
    <script src="./node_modules/rrweb-player/dist/index.js"></script>
    <input type="button" id="js-btn" value="æµ‹è¯•æ•°æ®" />
    <input type="text" />
    <h4>âºç”¨æˆ·æ“ä½œå›æº¯</h4>
    <hr />
    <div id="player"></div>
    <script>
      // const events = [];
      const eventsMatrix = [[]];
      rrweb.record({
        emit(event, isCheckout) {
          if (isCheckout) {
            eventsMatrix.push([]);
          }
          //æ•°æ®æŒ‡é’ˆ
          const lastEvents = eventsMatrix[eventsMatrix.length - 1];
          lastEvents.push(event);
          // events.push(event);
        },
        recordLog: true,
        checkoutEveryNth: 10,
        packFn: rrweb.pack,
      });
      // å›æ”¾æœ€å2æ­¥ ä½†å®é™…ä¸Šä¼ é€’çš„æ•°æ®è¿˜æ˜¯ç›¸å¯¹è¾ƒå¤šçš„
      window.onerror = function () {
        console.log('ğŸ“š', eventsMatrix);
        const len = eventsMatrix.length;
        const events = eventsMatrix[len - 2].concat(eventsMatrix[len - 1]);
        const body = JSON.stringify({ events });
        console.log('ğŸ»', events);
        // const replayer = new rrweb.Replayer(events, {
        //   unpackFn: rrweb.unpack,
        // });
        // replayer.play();
        const replayer = new rrwebPlayer({
          target: document.getElementById('player'), // customizable root element
          props: {
            events,
            // unpackFn: rrweb.unpack, é»˜è®¤è§£ç 
          },
        });
        console.log('è¾“å‡º', replayer.on);
        // replayer.on('play', (payload) => {
        //   console.log('å¼€å§‹æ’­æ”¾');
        // });
      };
      document.getElementById('js-btn').addEventListener('click', function () {
        // alert('äº¬ç¨‹ä¸€ç¯');
        console.log(x);
      });
    </script>
  </body>
</html>
